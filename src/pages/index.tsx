import Head from "next/head";
import {NextPage} from "next";
import styles from "../styles/Home.module.css";
import {Curl} from "../components/Curl";
import {useQuery, gql} from "@apollo/client";
import React, {useState} from "react";
import {Skills} from "../components/Skills";
import {Contacts} from "../components/Contacts";
import {me} from "../types/Me";

const Home: NextPage = () => {
    const [isLoading, setIsLoading] = useState<boolean>(true);

    const query = gql`
    query {
      me {
        name
        about
        age
        skills {
          id
          name
          types {
            name
            id
          }
        }
        histories {
          id
          time
          title
          about
        }
        contact {
          name
          url
        }
      }
    }
  `;

    const {data, loading, error} = useQuery(query);

    if (loading) {
        return <p>loading...</p>;
    }

    // check for errors
    if (error) {
        return <p>:( an error happened</p>;
    }

<<<<<<< HEAD
  const JsonComponent = dynamic(
    () => import("../components/Json").then((modules) => modules.Json),
    { ssr: false }
  );

  return (
    <div className={styles.container}>
      <Head>
        <title>Soshi portfolio</title>
        <meta name="description" content="$B$=$&$7$/$s$N%]!<%H%U%)%j%*(B" />
        <link
          rel="icon"
          href="https://pbs.twimg.com/profile_images/1386250147827372034/EhGcAlPk_400x400.jpg"
        />
      </Head>

      <main className={styles.main}>
        <h1>hello, I am {data.me[0].name}</h1>
        <h1>This is {data.me[0].name} portFolio</h1>
        <JsonComponent json={data.me[0]} />
      </main>
=======
    const swichLoading = () => {
        setIsLoading(false)
    }

    const me: me = data.me[0];

    return (
        <div className={styles.container}>
            <Head>
                <title>Create Next App</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
>>>>>>> cddb18bd2252aec7e3eff86405591f934f47edf0

            {!isLoading ?
                <>
                    <main className={styles.main}>
                        <div className={styles.hello}>
                            <h1>hello, I am {me.name}</h1>
                        </div>
                        <Skills skills={me.skills} />
                        <Contacts contacts={me.contact} />
                    </main>

<<<<<<< HEAD
      <footer className={styles.footer}></footer>
    </div>
  );
=======
                    <footer className={styles.footer}>
                        Powered by
                        <p className={styles.soshikun}>„Åù„ÅÜ„Åó„Åè„ÇìÔºÅ</p>
                    </footer>
                </>
                :
                <main>
                    <Curl swichLoading={swichLoading} />
                </main>
            }
        </div>
    );
>>>>>>> cddb18bd2252aec7e3eff86405591f934f47edf0
};

export default Home;
